<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>The Sift — Readable • Accessible • Credible</title>
    <meta
      name="description"
      content="A concept redesign of a news site balancing readability, accessibility, and credibility for students, professionals, and elderly readers."
    />

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Atkinson+Hyperlegible:wght@400;700&display=swap"
      rel="stylesheet"
    />

    <style>
      :root {
        --cn-primary: #2563eb;
        --cn-accent: #10b981;
        --cn-warm: #f59e0b;
        --cn-danger: #ef4444;
        --cn-bg: #ffffff;
        --cn-surface: #f8fafc;
        --cn-text: #0f172a;
        --cn-muted: #475569;
        --cn-shadow: 0 10px 30px rgba(2, 6, 23, 0.08);
        --cn-radius: 1.25rem;
        --cn-focus: 3px solid rgba(37, 99, 235, 0.5);
        --cn-line-height: 1.75;
        --cn-font: "Inter", system-ui, -apple-system, Segoe UI, Roboto, Ubuntu,
          "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji",
          "Segoe UI Emoji";
        --cn-font-accessible: "Atkinson Hyperlegible", var(--cn-font);
      }

      [data-bs-theme="dark"] {
        --cn-bg: #0b1220;
        --cn-surface: #0f172a;
        --cn-text: #e5e7eb;
        --cn-muted: #94a3b8;
        --cn-shadow: 0 10px 30px rgba(0, 0, 0, 0.45);
      }

      [data-contrast="high"] {
        --cn-primary: #0000ff;
        --cn-accent: #00ff00;
        --cn-warm: #ffff00;
        --cn-danger: #ff0000;
      }

      html,
      body {
        background: var(--cn-bg);
        color: var(--cn-text);
        font-family: var(--cn-font);
        line-height: var(--cn-line-height);
      }

      .skip-link {
        position: absolute;
        top: -40px;
        left: 0;
        background: var(--cn-primary);
        color: #fff;
        padding: 0.5rem 1rem;
        z-index: 2000;
        border-radius: 0.5rem;
      }
      .skip-link:focus {
        top: 0.5rem;
        outline: var(--cn-focus);
      }

      .navbar {
        position: sticky;
        top: 0;
        z-index: 1000;
        backdrop-filter: saturate(1.2) blur(6px);
        background: color-mix(in oklab, var(--cn-bg) 70%, transparent);
        box-shadow: var(--cn-shadow);
      }
      .weather-badge {
        background: var(--cn-surface);
        border: 1px solid var(--cn-muted);
        color: var(--cn-text);
        padding: 0.5rem 1rem;
        border-radius: 999px;
        font-weight: 600;
      }
      .navbar-brand .logo-icon {
        font-size: 1.5rem;
        color: var(--cn-primary);
      }

      .main-container {
        max-width: 1400px;
        padding-left: 2rem;
        padding-right: 2rem;
      }

      @media (min-width: 992px) {
        .main-container {
          padding-left: 3rem;
          padding-right: 3rem;
        }
      }

      .hero-card {
        border: 0;
        border-radius: var(--cn-radius);
        overflow: hidden;
        box-shadow: var(--cn-shadow);
        background: linear-gradient(
            180deg,
            rgba(37, 99, 235, 0.08),
            transparent 40%
          ),
          var(--cn-surface);
      }
      .hero-img {
        max-height: 420px;
        object-fit: cover;
      }

      .news-card {
        border: 0;
        border-radius: var(--cn-radius);
        box-shadow: var(--cn-shadow);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        background: var(--cn-surface);
      }
      .news-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 14px 40px rgba(2, 6, 23, 0.12);
      }

      .badge-cred {
        font-weight: 700;
        letter-spacing: 0.02em;
      }
      .badge-cred[data-level="high"] {
        background: color-mix(in srgb, var(--cn-accent) 85%, #fff 15%);
      }
      .badge-cred[data-level="medium"] {
        background: color-mix(in srgb, var(--cn-warm) 85%, #fff 15%);
      }
      .badge-cred[data-level="low"] {
        background: color-mix(in srgb, var(--cn-danger) 85%, #fff 15%);
      }

      .control-pill {
        border-radius: 999px;
        box-shadow: var(--cn-shadow);
        background: var(--cn-surface);
        color: var(--cn-text);
      }
      .btn-outline-secondary {
        border-color: var(--cn-muted);
        color: var(--cn-muted);
      }

      [data-bs-theme="dark"] .control-pill {
        color: var(--cn-text);
        background: var(--cn-surface);
      }

      .myth-card,
      .explainer-card,
      .source-card {
        background: var(--cn-surface);
        border: 1px solid
          color-mix(in oklab, var(--cn-surface) 80%, var(--cn-muted));
        border-radius: var(--cn-radius);
        box-shadow: var(--cn-shadow);
        transition: transform 0.2s ease, box-shadow 0.2s ease;
      }
      .myth-card:hover,
      .explainer-card:hover,
      .source-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 14px 40px rgba(2, 6, 23, 0.12);
      }

      .myth-label {
        font-weight: 700;
        padding: 0.3em 0.7em;
        border-radius: 0.5rem;
        display: inline-flex;
        align-items: center;
        gap: 0.3rem;
      }
      .myth-label.myth {
        background-color: var(--cn-danger);
        color: white;
      }
      .myth-label.fact {
        background-color: var(--cn-accent);
        color: white;
      }

      .explainer-label,
      .source-label {
        font-weight: 700;
        padding: 0.3em 0.7em;
        border-radius: 0.5rem;
        display: inline-flex;
        align-items: center;
        gap: 0.3rem;
        background-color: var(--cn-primary);
        color: white;
      }

      .reader-content {
        font-size: 1.125rem;
        max-width: 70ch;
        margin: 0 auto;
      }
      .reader-content[data-density="relaxed"] {
        line-height: 1.95;
        letter-spacing: 0.01em;
      }
      .reader-content[data-density="compact"] {
        line-height: 1.55;
      }
      .progress-reader {
        height: 6px;
        border-radius: 999px;
      }

      .rounded-2xl {
        border-radius: var(--cn-radius) !important;
      }
      .shadow-xl {
        box-shadow: var(--cn-shadow) !important;
      }
      .focus-ring {
        outline: none !important;
        box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.35) !important;
      }

      *:focus-visible {
        outline: var(--cn-focus);
        outline-offset: 2px;
        border-radius: 0.5rem;
      }

      .pin {
        position: absolute;
        top: 0.75rem;
        right: 0.75rem;
        background: rgba(0, 0, 0, 0.55);
        color: #fff;
        border-radius: 999px;
        padding: 0.35rem 0.5rem;
        backdrop-filter: blur(3px);
      }

      .tooltip-inner {
        text-align: left;
      }

      .form-range::-webkit-slider-thumb {
        background: var(--cn-primary);
      }

      .shimmer {
        position: relative;
        overflow: hidden;
      }
      .shimmer::after {
        content: "";
        position: absolute;
        inset: 0;
        transform: translateX(-100%);
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.35),
          transparent
        );
        animation: shimmer 1.2s infinite;
      }
      @keyframes shimmer {
        100% {
          transform: translateX(100%);
        }
      }

      @media (min-width: 992px) {
        .sticky-lg-top-20 {
          position: sticky;
          top: 90px;
        }
      }

      .custom-modal-header {
        background: var(--cn-surface);
        border-bottom: none;
        padding: 2rem;
      }

      .custom-modal-body {
        background: var(--cn-bg);
        padding: 2rem;
        border-radius: 0 0 var(--cn-radius) var(--cn-radius);
      }

      .custom-modal-title {
        font-size: 1.5rem;
        font-weight: 800;
        color: var(--cn-text);
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .custom-modal-content {
        border: 0;
        border-radius: var(--cn-radius);
        box-shadow: var(--cn-shadow);
      }

      .footer-logo {
        color: var(--cn-primary) !important;
      }
    </style>
  </head>
  <body>
    <a class="skip-link" href="#main">Skip to content</a>

    <nav class="navbar navbar-expand-lg py-3" aria-label="Primary">
      <div class="container main-container">
        <a
          class="navbar-brand fw-bold d-flex align-items-center gap-2"
          href="#"
          aria-label="The Sift Home"
        >
          <i class="bi bi-funnel-fill logo-icon"></i>
          <span>The <span class="text-primary">Sift</span></span>
        </a>

        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navMain"
          aria-controls="navMain"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navMain">
          <form
            class="d-flex ms-lg-4 my-3 my-lg-0 flex-grow-1"
            role="search"
            aria-label="Site search"
          >
            <div class="input-group shadow-sm">
              <span class="input-group-text bg-transparent border-end-0"
                ><i class="bi bi-search"></i
              ></span>
              <input
                id="searchInput"
                class="form-control border-start-0"
                type="search"
                placeholder="Search topics, sources, or tags…"
                aria-label="Search"
              />
              <button class="btn btn-primary" type="button" id="searchBtn">
                Search
              </button>
            </div>
          </form>

          <ul class="navbar-nav ms-lg-4 align-items-lg-center gap-lg-2">
            <li class="nav-item">
              <span
                id="weatherInfo"
                class="weather-badge d-flex align-items-center gap-2"
              >
              </span>
            </li>
            <li class="nav-item dropdown">
              <button
                class="btn btn-light control-pill dropdown-toggle"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                aria-label="Audience presets"
              >
                <i class="bi bi-people me-1"></i> Audience
              </button>
              <ul class="dropdown-menu dropdown-menu-end shadow-xl rounded-2xl">
                <li>
                  <button class="dropdown-item" data-preset="student">
                    Student
                  </button>
                </li>
                <li>
                  <button class="dropdown-item" data-preset="professional">
                    Professional
                  </button>
                </li>
                <li>
                  <button class="dropdown-item" data-preset="elder">
                    Elderly
                  </button>
                </li>
              </ul>
            </li>
            <li class="nav-item dropdown">
              <button
                class="btn btn-light control-pill dropdown-toggle"
                data-bs-toggle="dropdown"
                aria-expanded="false"
                aria-label="Display options"
              >
                <i class="bi bi-sliders2-vertical me-1"></i> Display
              </button>
              <div
                class="dropdown-menu dropdown-menu-end p-3 shadow-xl rounded-2xl"
                style="min-width: 320px"
              >
                <div class="mb-2 small text-muted">Quick display controls</div>
                <div
                  class="d-flex align-items-center justify-content-between mb-3"
                >
                  <span><i class="bi bi-brightness-high me-2"></i> Theme</span>
                  <div class="btn-group" role="group" aria-label="Theme toggle">
                    <button
                      class="btn btn-outline-secondary btn-sm"
                      data-theme="light"
                    >
                      Light
                    </button>
                    <button
                      class="btn btn-outline-secondary btn-sm"
                      data-theme="dark"
                    >
                      Dark
                    </button>
                    <button
                      class="btn btn-outline-secondary btn-sm"
                      data-contrast="toggle"
                    >
                      High Contrast
                    </button>
                  </div>
                </div>
                <div
                  class="d-flex align-items-center justify-content-between mb-3"
                >
                  <span><i class="bi bi-type me-2"></i> Font Size</span>
                  <div class="btn-group" role="group" aria-label="Font size">
                    <button
                      class="btn btn-outline-secondary btn-sm"
                      data-font="-"
                    >
                      A-
                    </button>
                    <button
                      class="btn btn-outline-secondary btn-sm"
                      data-font="0"
                    >
                      A
                    </button>
                    <button
                      class="btn btn-outline-secondary btn-sm"
                      data-font="+"
                    >
                      A+
                    </button>
                  </div>
                </div>
                <div class="mb-2">
                  <label for="densityRange" class="form-label"
                    ><i class="bi bi-layout-text-window-reverse me-2"></i
                    >Content Density</label
                  >
                  <input
                    type="range"
                    class="form-range"
                    min="0"
                    max="2"
                    step="1"
                    id="densityRange"
                    aria-label="Content density"
                  />
                  <div class="d-flex justify-content-between small text-muted">
                    <span>Compact</span><span>Comfort</span><span>Relaxed</span>
                  </div>
                </div>
                <div class="form-check form-switch mt-2">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    role="switch"
                    id="dyslexiaFontSwitch"
                  />
                  <label class="form-check-label" for="dyslexiaFontSwitch"
                    >Use accessible font</label
                  >
                </div>
              </div>
            </li>
            <li class="nav-item">
              <button
                class="btn btn-primary control-pill"
                data-bs-toggle="modal"
                data-bs-target="#kbModal"
                aria-label="Keyboard shortcuts"
              >
                <i class="bi bi-keyboard"></i>
                <span class="d-none d-xl-inline">Shortcuts</span>
              </button>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <main class="container main-container my-4" id="main">
      <div class="row g-4">
        <aside class="col-lg-3">
          <div
            class="p-3 rounded-2xl shadow-xl"
            style="background: var(--cn-surface)"
          >
            <h2 class="h5 mb-3">Refine Feed</h2>
            <div class="mb-3">
              <div class="small text-muted mb-2">Categories</div>
              <div
                class="d-flex flex-wrap gap-2"
                id="categoryChips"
                role="group"
                aria-label="Categories"
              ></div>
            </div>
            <hr />
            <div class="mb-3">
              <div class="small text-muted mb-2">Credibility</div>
              <div
                class="btn-group w-100"
                role="group"
                aria-label="Credibility"
              >
                <button
                  class="btn btn-outline-success btn-sm active"
                  data-cred="high"
                >
                  High
                </button>
                <button
                  class="btn btn-outline-warning btn-sm"
                  data-cred="medium"
                >
                  Med
                </button>
                <button class="btn btn-outline-danger btn-sm" data-cred="low">
                  Low
                </button>
              </div>
            </div>
            <div class="mb-3">
              <label class="form-label small text-muted"
                >Reading time ≤ <span id="rtVal">10</span> min</label
              >
              <input
                type="range"
                class="form-range"
                min="3"
                max="20"
                step="1"
                id="rtRange"
                aria-label="Reading time filter"
              />
            </div>
            <div class="mb-3">
              <div class="form-check">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="factCheckOnly"
                />
                <label class="form-check-label" for="factCheckOnly"
                  >Fact-checked only</label
                >
              </div>
            </div>
            <div class="mt-4">
              <button id="resetFilters" class="btn btn-outline-secondary w-100">
                Reset Filters
              </button>
            </div>
          </div>

          <div
            class="p-3 rounded-2xl shadow-xl mt-4 sticky-lg-top-20"
            style="background: var(--cn-surface)"
          >
            <h2 class="h6">Trending on Google</h2>
            <p class="small text-muted">Popular queries people search for:</p>
            <ul class="list-unstyled" id="googleTrends"></ul>
          </div>
        </aside>

        <section class="col-lg-9">
          <div class="card hero-card mb-4">
            <div class="row g-0 align-items-center">
              <div class="col-md-6">
                <img
                  class="hero-img w-100"
                  src="https://images.unsplash.com/photo-1504711434969-e33886168f5c?q=80&w=1600&auto=format&fit=crop"
                  alt="Newsroom with editors collaborating"
                />
              </div>
              <div class="col-md-6 p-4 p-md-5">
                <span
                  class="badge rounded-pill bg-primary-subtle text-primary mb-2"
                  >Featured</span
                >
                <h1 class="h3 fw-bold">
                  Today’s Brief: Clear, Credible, and Crafted for You
                </h1>
                <p class="mb-3 text-muted">
                  A calm, ad-light reading experience that adapts to your
                  needs—better typography, smarter filters, and transparent
                  sourcing.
                </p>
                <div class="d-flex gap-2 align-items-center mb-3">
                  <span
                    class="badge badge-cred"
                    data-level="high"
                    aria-label="High credibility"
                    >High credibility</span
                  >
                  <span class="badge text-bg-light"
                    ><i class="bi bi-clock me-1"></i>6 min read</span
                  >
                  <span class="badge text-bg-light"
                    ><i class="bi bi-people me-1"></i>For all audiences</span
                  >
                </div>
                <div class="d-flex gap-2">
                  <button class="btn btn-primary" id="openFeatured">
                    Read Featured
                  </button>
                  <button class="btn btn-outline-primary" id="saveFeatured">
                    <i class="bi bi-bookmark me-1"></i>Save
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="d-flex justify-content-between align-items-center mb-2">
            <h2 class="h4 m-0 fw-bold">
              Top Stories <i class="bi bi-newspaper text-primary"></i>
            </h2>
            <div class="small text-muted" id="resultsCount">0 articles</div>
          </div>

          <div
            id="feed"
            class="row g-4"
            aria-live="polite"
            aria-busy="true"
          ></div>

          <div class="text-center mt-4">
            <button class="btn btn-outline-secondary px-4" id="loadMore">
              <i class="bi bi-arrow-repeat me-1"></i>Load more
            </button>
          </div>

          <hr class="my-5" />

          <section class="mb-5">
            <h2 class="h4 mb-4 fw-bold">
              Myth Busters <i class="bi bi-patch-check-fill text-primary"></i>
            </h2>
            <p class="text-muted">
              Separating fact from fiction on common beliefs and misinformation.
            </p>
            <div class="row g-4">
              <div class="col-md-6">
                <div class="myth-card p-4 h-100 d-flex flex-column">
                  <span class="myth-label myth mb-3"
                    ><i class="bi bi-x-circle-fill"></i>MYTH</span
                  >
                  <h3 class="h5 fw-bold text-danger">
                    Organic food is always healthier.
                  </h3>
                  <p class="text-muted flex-grow-1">
                    While organic food has benefits, "healthier" is not a
                    universal truth. Nutritional value varies based on many
                    factors, and non-organic foods can be just as good.
                  </p>
                  <div class="mt-auto">
                    <button
                      class="btn btn-outline-primary btn-sm"
                      data-bs-toggle="modal"
                      data-bs-target="#mythModal"
                      data-myth-id="1"
                    >
                      Read the full fact-check <i class="bi bi-arrow-right"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="myth-card p-4 h-100 d-flex flex-column">
                  <span class="myth-label myth mb-3"
                    ><i class="bi bi-x-circle-fill"></i>MYTH</span
                  >
                  <h3 class="h5 fw-bold text-danger">
                    You need to drink 8 glasses of water a day.
                  </h3>
                  <p class="text-muted flex-grow-1">
                    This is a popular but outdated recommendation. Your daily
                    fluid intake depends on your activity level, climate, and
                    overall health.
                  </p>
                  <div class="mt-auto">
                    <button
                      class="btn btn-outline-primary btn-sm"
                      data-bs-toggle="modal"
                      data-bs-target="#mythModal"
                      data-myth-id="2"
                    >
                      Read the full fact-check <i class="bi bi-arrow-right"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-12">
                <div class="myth-card p-4 h-100 d-flex flex-column">
                  <span class="myth-label myth mb-3"
                    ><i class="bi bi-x-circle-fill"></i>MYTH</span
                  >
                  <h3 class="h5 fw-bold text-danger">
                    Artificial intelligence is sentient or conscious.
                  </h3>
                  <p class="text-muted flex-grow-1">
                    This is a common misconception from science fiction. Current
                    AI systems are sophisticated pattern-matching tools. They do
                    not have genuine consciousness, feelings, or self-awareness.
                  </p>
                  <div class="mt-auto">
                    <button
                      class="btn btn-outline-primary btn-sm"
                      data-bs-toggle="modal"
                      data-bs-target="#mythModal"
                      data-myth-id="3"
                    >
                      Read the full fact-check <i class="bi bi-arrow-right"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <hr class="my-5" />

          <section class="mb-5">
            <h2 class="h4 mb-4 fw-bold">
              Explainers <i class="bi bi-info-circle-fill text-primary"></i>
            </h2>
            <p class="text-muted">
              Breaking down complex topics for easy understanding.
            </p>
            <div class="row g-4">
              <div class="col-md-6">
                <div class="explainer-card p-4 h-100 d-flex flex-column">
                  <span class="explainer-label mb-3"
                    ><i class="bi bi-lightbulb-fill"></i>EXPLAINER</span
                  >
                  <h3 class="h5 fw-bold text-primary">
                    What is Quantitative Easing?
                  </h3>
                  <p class="text-muted flex-grow-1">
                    Understand how central banks stimulate economies by buying
                    government bonds and other financial assets, and what it
                    means for you.
                  </p>
                  <div class="mt-auto">
                    <button
                      class="btn btn-outline-primary btn-sm"
                      data-bs-toggle="modal"
                      data-bs-target="#explainerModal"
                      data-explainer-id="1"
                    >
                      Learn More <i class="bi bi-arrow-right"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="explainer-card p-4 h-100 d-flex flex-column">
                  <span class="explainer-label mb-3"
                    ><i class="bi bi-lightbulb-fill"></i>EXPLAINER</span
                  >
                  <h3 class="h5 fw-bold text-primary">
                    The Basics of Artificial Intelligence
                  </h3>
                  <p class="text-muted flex-grow-1">
                    Demystifying AI: how machines learn, process information,
                    and impact our daily lives, from algorithms to neural
                    networks.
                  </p>
                  <div class="mt-auto">
                    <button
                      class="btn btn-outline-primary btn-sm"
                      data-bs-toggle="modal"
                      data-bs-target="#explainerModal"
                      data-explainer-id="2"
                    >
                      Learn More <i class="bi bi-arrow-right"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-12">
                <div class="explainer-card p-4 h-100 d-flex flex-column">
                  <span class="explainer-label mb-3"
                    ><i class="bi bi-lightbulb-fill"></i>EXPLAINER</span
                  >
                  <h3 class="h5 fw-bold text-primary">
                    Decoding Climate Change Terminology
                  </h3>
                  <p class="text-muted flex-grow-1">
                    From "carbon footprint" to "net-zero" and "IPCC reports,"
                    get clear definitions and context for key terms in climate
                    discussions.
                  </p>
                  <div class="mt-auto">
                    <button
                      class="btn btn-outline-primary btn-sm"
                      data-bs-toggle="modal"
                      data-bs-target="#explainerModal"
                      data-explainer-id="3"
                    >
                      Learn More <i class="bi bi-arrow-right"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <hr class="my-5" />

          <section class="mb-5">
            <h2 class="h4 mb-4 fw-bold">
              Source Spotlight
              <i class="bi bi-patch-question-fill text-primary"></i>
            </h2>
            <p class="text-muted">
              A guide to understanding news sources and media literacy.
            </p>
            <div class="row g-4">
              <div class="col-md-6">
                <div class="source-card p-4 h-100 d-flex flex-column">
                  <span class="source-label mb-3"
                    ><i class="bi bi-journal-text"></i>PROFILE</span
                  >
                  <h3 class="h5 fw-bold text-primary">
                    Reuters: A Global, Fact-Based Approach
                  </h3>
                  <p class="text-muted flex-grow-1">
                    Learn about Reuters' century-long history, its commitment to
                    neutral, objective reporting, and its role as a wire service
                    for other news outlets.
                  </p>
                  <div class="mt-auto">
                    <button
                      class="btn btn-outline-primary btn-sm"
                      data-bs-toggle="modal"
                      data-bs-target="#sourceModal"
                      data-source-id="1"
                    >
                      View Profile <i class="bi bi-arrow-right"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="source-card p-4 h-100 d-flex flex-column">
                  <span class="source-label mb-3"
                    ><i class="bi bi-journal-text"></i>GUIDE</span
                  >
                  <h3 class="h5 fw-bold text-primary">
                    How to Spot Misleading Headlines
                  </h3>
                  <p class="text-muted flex-grow-1">
                    A quick guide to identifying headlines designed to grab
                    attention rather than inform. Learn to differentiate between
                    clickbait and factual reporting.
                  </p>
                  <div class="mt-auto">
                    <button
                      class="btn btn-outline-primary btn-sm"
                      data-bs-toggle="modal"
                      data-bs-target="#sourceModal"
                      data-source-id="2"
                    >
                      Read Guide <i class="bi bi-arrow-right"></i>
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-12">
                <div class="source-card p-4 h-100 d-flex flex-column">
                  <span class="source-label mb-3"
                    ><i class="bi bi-journal-text"></i>PROFILE</span
                  >
                  <h3 class="h5 fw-bold text-primary">
                    The Verge: Tech News with a Human Touch
                  </h3>
                  <p class="text-muted flex-grow-1">
                    Discover how The Verge balances in-depth tech analysis with
                    cultural commentary, and what its focus on the intersection
                    of tech and society means for its content.
                  </p>
                  <div class="mt-auto">
                    <button
                      class="btn btn-outline-primary btn-sm"
                      data-bs-toggle="modal"
                      data-bs-target="#sourceModal"
                      data-source-id="3"
                    >
                      View Profile <i class="bi bi-arrow-right"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </section>
      </div>
    </main>

    <div
      class="modal fade"
      id="readerModal"
      tabindex="-1"
      aria-labelledby="readerTitle"
      aria-hidden="true"
    >
      <div
        class="modal-dialog modal-fullscreen-md-down modal-lg modal-dialog-scrollable"
      >
        <div class="modal-content rounded-2xl">
          <div class="modal-header">
            <h3 class="modal-title h5" id="readerTitle">Article</h3>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <div class="progress progress-reader mb-3">
              <div
                class="progress-bar"
                role="progressbar"
                style="width: 0%"
                id="readerProgress"
                aria-label="Reading progress"
              ></div>
            </div>
            <div class="d-flex flex-wrap gap-2 mb-3">
              <span class="badge text-bg-light" id="readerMeta"></span>
              <span class="badge badge-cred" id="readerCred"></span>
              <button
                class="btn btn-sm btn-outline-secondary"
                id="readerFontInc"
                aria-label="Increase font size"
              >
                A+
              </button>
              <button
                class="btn btn-sm btn-outline-secondary"
                id="readerFontDec"
                aria-label="Decrease font size"
              >
                A-
              </button>
              <div
                class="btn-group btn-group-sm"
                role="group"
                aria-label="Reader density"
              >
                <button
                  class="btn btn-outline-secondary"
                  data-density="compact"
                >
                  Compact
                </button>
                <button
                  class="btn btn-outline-secondary active"
                  data-density="comfort"
                >
                  Comfort
                </button>
                <button
                  class="btn btn-outline-secondary"
                  data-density="relaxed"
                >
                  Relaxed
                </button>
              </div>
              <button class="btn btn-sm btn-outline-primary" id="readerSave">
                <i class="bi bi-bookmark me-1"></i>Save
              </button>
            </div>
            <article
              id="readerBody"
              class="reader-content"
              data-density="comfort"
            ></article>
            <hr />
            <details class="mt-3">
              <summary class="fw-semibold">
                Why we consider this credible
              </summary>
              <ul class="mt-2" id="readerWhy"></ul>
            </details>
            <div class="mt-3">
              <div class="small text-muted">Sources</div>
              <ul id="readerSources" class="small"></ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="mythModal"
      tabindex="-1"
      aria-labelledby="mythModalTitle"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content custom-modal-content">
          <div class="modal-header custom-modal-header">
            <h5 class="custom-modal-title" id="mythModalTitle">
              <i class="bi bi-patch-question-fill text-danger"></i> Myth Buster
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body custom-modal-body">
            <div id="mythModalContent"></div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="explainerModal"
      tabindex="-1"
      aria-labelledby="explainerModalTitle"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content custom-modal-content">
          <div class="modal-header custom-modal-header">
            <h5 class="custom-modal-title" id="explainerModalTitle">
              <i class="bi bi-info-circle-fill text-primary"></i> Explainer
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body custom-modal-body">
            <div id="explainerModalContent"></div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="sourceModal"
      tabindex="-1"
      aria-labelledby="sourceModalTitle"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content custom-modal-content">
          <div class="modal-header custom-modal-header">
            <h5 class="custom-modal-title" id="sourceModalTitle">
              <i class="bi bi-journal-text text-primary"></i> Source Spotlight
            </h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body custom-modal-body">
            <div id="sourceModalContent"></div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade"
      id="kbModal"
      tabindex="-1"
      aria-labelledby="kbTitle"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content rounded-2xl">
          <div class="modal-header">
            <h3 class="modal-title h5" id="kbTitle">Keyboard shortcuts</h3>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <ul class="list-group">
              <li class="list-group-item"><kbd>/</kbd> Focus search</li>
              <li class="list-group-item"><kbd>?</kbd> Open this help</li>
              <li class="list-group-item">
                <kbd>j</kbd>/<kbd>k</kbd> Move between articles
              </li>
              <li class="list-group-item">
                <kbd>o</kbd> Open selected article
              </li>
              <li class="list-group-item">
                <kbd>b</kbd> Bookmark selected article
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1080">
      <div
        id="toaster"
        class="toast align-items-center text-bg-dark border-0"
        role="status"
        aria-live="polite"
        aria-atomic="true"
      >
        <div class="d-flex">
          <div class="toast-body">Saved to bookmarks</div>
          <button
            type="button"
            class="btn-close btn-close-white me-2 m-auto"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
      </div>
    </div>

    <footer class="container main-container py-5 border-top">
      <div class="row g-4 justify-content-center">
        <div class="col-md-5">
          <h4 class="fw-bold"><span class="footer-logo">The Sift</span></h4>
          <p class="text-muted m-0">
            A trusted source for clear, credible news, designed for everyone.
          </p>
          <div class="mt-3">
            <a href="#" class="me-2 text-primary"
              ><i class="bi bi-twitter-x h4"></i
            ></a>
            <a href="#" class="me-2 text-primary"
              ><i class="bi bi-facebook h4"></i
            ></a>
            <a href="#" class="me-2 text-primary"
              ><i class="bi bi-linkedin h4"></i
            ></a>
            <a href="#" class="me-2 text-primary"
              ><i class="bi bi-youtube h4"></i
            ></a>
          </div>
        </div>
        <div class="col-md-4">
          <h5 class="fw-bold">Newsletter</h5>
          <p class="small text-muted">
            Stay informed with our daily brief delivered to your inbox.
          </p>
          <div class="input-group mb-3">
            <input
              type="email"
              class="form-control"
              placeholder="Your email address"
              aria-label="Your email address"
            />
            <button class="btn btn-primary" type="button">Subscribe</button>
          </div>
        </div>
        <div class="col-md-3 text-md-end">
          <button class="btn btn-outline-secondary w-100" id="viewBookmarks">
            <i class="bi bi-bookmarks me-1"></i> View bookmarks
          </button>
        </div>
      </div>
      <div class="row mt-4 align-items-center">
        <div class="col-12 col-md-8 text-center text-md-start text-muted small">
          &copy; 2025 The Sift. All rights reserved.
        </div>
        <div class="col-12 col-md-4 text-center text-md-end text-muted small">
          <span id="energyImpact"></span>
        </div>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
      // =====================
      // Demo data & utilities
      // =====================
      const CATEGORIES = [
        "Top",
        "India",
        "World",
        "Business",
        "Tech",
        "Science",
        "Health",
        "Sports",
        "Entertainment",
        "Climate",
        "Culture",
        "Politics",
        "Lifestyle",
      ];

      const GOOGLE_QUERIES = [
        "india monsoon update today",
        "stock market news today",
        "ai safety latest",
        "champions league fixtures",
        "ipl points table",
        "tech layoffs 2025",
        "climate change report",
        "gold rate today",
        "usd inr exchange rate",
        "covid booster guidelines",
      ];

      const MYTHS = {
        1: {
          title: "Organic food is always healthier.",
          body: `
            <p><strong>Fact:</strong> The term "organic" primarily refers to how food is grown, not its nutritional content. Organic farming avoids synthetic pesticides and fertilizers, which is beneficial for the environment, but doesn't guarantee higher vitamin or mineral levels. Multiple studies have shown the nutritional differences between organic and conventional produce are minimal. The healthiest diet is one rich in fruits, vegetables, and whole grains, regardless of whether they are organic.</p>
            <p><strong>Deeper Dive:</strong> While some studies have found small increases in certain nutrients in organic produce, these are often not significant enough to impact human health. The primary benefits of organic farming are often environmental, such as promoting biodiversity and reducing exposure to certain chemicals. For human health, the most important factor is the quantity and variety of fruits and vegetables consumed, not just the label.</p>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">Stanford University School of Medicine study</a></li>
              <li><a href="#" class="link-primary">Mayo Clinic article on organic foods</a></li>
            </ul>
          `,
        },
        2: {
          title: "You need to drink 8 glasses of water a day.",
          body: `
            <p><strong>Fact:</strong> The "8 glasses a day" rule is a popular but outdated myth. The truth is that your hydration needs are highly individual. Factors like your activity level, the climate, your body size, and your diet all play a role. A good guideline is to drink water when you feel thirsty. Your body is excellent at signaling its needs. You also get a significant amount of water from foods like fruits and vegetables.</p>
            <p><strong>Deeper Dive:</strong> A person's water needs can fluctuate wildly. An athlete in a hot climate may need significantly more water than someone who works in an air-conditioned office. The recommendation also ignores the fluid content of coffee, tea, and other beverages. Listening to your body's thirst signals is the most reliable method for staying properly hydrated.</p>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">Harvard Health Publishing report</a></li>
              <li><a href="#" class="link-primary">National Academies of Sciences, Engineering, and Medicine guidelines</a></li>
            </ul>
          `,
        },
        3: {
          title: "Artificial intelligence is sentient or conscious.",
          body: `
            <p><strong>Fact:</strong> This is a powerful and persistent misconception, largely fueled by science fiction. Today's AI systems, no matter how advanced, are not conscious. They are complex algorithms designed to recognize patterns, process data, and generate responses based on that data. They lack self-awareness, emotions, and personal experiences. The human brain operates on a fundamentally different level of biological complexity and consciousness that we are only just beginning to understand.</p>
            <p><strong>Deeper Dive:</strong> The illusion of consciousness in AI, particularly in large language models, comes from their ability to mimic human-like conversation. They do this by processing vast amounts of text to predict the most probable next word in a sentence. They don't "know" or "feel" anything; they are simply executing a program. The philosophical and scientific communities widely agree that sentience in AI is still a far-off concept, if it is even possible at all.</p>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">MIT Computer Science and Artificial Intelligence Laboratory research</a></li>
              <li><a href="#" class="link-primary">Expert interview with AI ethicist Dr. Emily Chang</a></li>
            </ul>
          `,
        },
        4: {
          title: "Cracking your knuckles causes arthritis.",
          body: `
            <p><strong>Fact:</strong> The "cracking" sound is caused by gas bubbles bursting in the fluid surrounding your joints, not bones grinding together. Extensive studies, including a long-term one by a doctor who cracked the knuckles on one hand for 50 years, have found no link between this habit and an increased risk of arthritis.</p>
            <p><strong>Deeper Dive:</strong> While the habit itself is harmless to your joints, it might lead to minor swelling or a weakened grip over time. However, the connection to arthritis is a myth. The main risk factors for arthritis are age, genetics, and injuries.</p>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">Johns Hopkins Arthritis Center</a></li>
              <li><a href="#" class="link-primary">Dr. Donald Unger's "knuckle-cracking experiment"</a></li>
            </ul>
          `,
        },
      };

      const EXPLAINERS = {
        1: {
          title: "What is Quantitative Easing?",
          body: `
            <p><strong>Quantitative Easing (QE)</strong> is a monetary policy tool used by central banks, like the Reserve Bank of India (RBI) or the US Federal Reserve, to stimulate the economy when conventional monetary policy (like lowering interest rates) is no longer effective.</p>
            <p><strong>How it works:</strong> The central bank buys large quantities of government bonds and other financial assets from commercial banks. This injects money into the financial system, increasing the money supply. This, in turn, aims to:</p>
            <ul>
              <li>Lower long-term interest rates, making it cheaper for businesses and individuals to borrow.</li>
              <li>Encourage banks to lend more, as they have more cash reserves.</li>
              <li>Boost investment and consumption, stimulating economic growth and preventing a recession.</li>
            </ul>
            <p><strong>Impact:</strong> While QE can be effective, it also carries risks, such as inflation and creating asset bubbles. It's a complex tool that central banks use cautiously in times of economic distress.</p>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">Reserve Bank of India (RBI) Explainer</a></li>
              <li><a href="#" class="link-primary">Investopedia: Quantitative Easing</a></li>
            </ul>
          `,
        },
        2: {
          title: "The Basics of Artificial Intelligence",
          body: `
            <p><strong>Artificial Intelligence (AI)</strong> refers to the simulation of human intelligence in machines that are programmed to think like humans and mimic their actions. It encompasses various fields, including machine learning, deep learning, natural language processing, and robotics.</p>
            <p><strong>Key Concepts:</strong></p>
            <ul>
              <li><strong>Machine Learning:</strong> A subset of AI where systems learn from data without explicit programming, identifying patterns and making predictions.</li>
              <li><strong>Neural Networks:</strong> Inspired by the human brain, these are layers of algorithms designed to recognize complex patterns, often used for image and speech recognition.</li>
              <li><strong>Natural Language Processing (NLP):</strong> The field that enables computers to understand, interpret, and generate human language. It's what powers tools like chatbots and voice assistants.</li>
            </ul>
            <p><strong>Applications:</strong> AI is used in everyday applications like personalized recommendation systems (Netflix, Spotify), voice assistants (Siri, Google Assistant), fraud detection, and medical diagnostics. As the technology evolves, its applications are becoming more widespread and integrated into our daily lives.</p>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">IBM: What is Artificial Intelligence?</a></li>
              <li><a href="#" class="link-primary">Google AI Blog</a></li>
            </ul>
          `,
        },
        3: {
          title: "Decoding Climate Change Terminology",
          body: `
            <p>Understanding climate change requires familiarity with specific terms. Here's a quick guide:</p>
            <ul>
              <li><strong>Carbon Footprint:</strong> The total greenhouse gas emissions caused by an individual, event, organization, or product. It's a measure of human impact on the environment.</li>
              <li><strong>Net-Zero:</strong> Achieving an overall balance between greenhouse gas emissions produced and greenhouse gas emissions taken out of the atmosphere. The goal is to reach this state by reducing emissions as much as possible and offsetting the rest through measures like carbon capture.</li>
              <li><strong>IPCC (Intergovernmental Panel on Climate Change):</strong> The UN body for assessing climate change science. It provides regular assessments of the scientific basis of climate change, its impacts, and future risks, and options for adaptation and mitigation.</li>
              <li><strong>Greenhouse Gases (GHGs):</strong> Gases that trap heat in the atmosphere, leading to the greenhouse effect. The main GHGs are carbon dioxide (CO2), methane (CH4), and nitrous oxide (N2O).</li>
              <li><strong>Climate Adaptation:</strong> Adjusting to actual or expected future climate. The goal is to reduce vulnerability to the harmful effects of climate change through strategies like building seawalls or developing drought-resistant crops.</li>
            </ul>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">United Nations Climate Action Glossary</a></li>
              <li><a href="#" class="link-primary">NASA Global Climate Change: Key Terms</a></li>
            </ul>
          `,
        },
        4: {
          title: "What is a Smart City?",
          body: `
            <p>A <strong>Smart City</strong> uses information and communication technologies (ICT) to enhance operational efficiency, share information with the public, and improve both the quality of government services and citizen welfare. At its core, a smart city is about using technology to make urban environments more livable, sustainable, and efficient.</p>
            <p><strong>Key Components:</strong></p>
            <ul>
              <li><strong>Smart Infrastructure:</strong> Includes smart grids for electricity, intelligent transportation systems, and connected buildings.</li>
              <li><strong>Citizen Engagement:</strong> Mobile apps and online platforms allow citizens to report issues and access government services easily.</li>
              <li><strong>Data-Driven Decisions:</strong> Cities collect real-time data from sensors and devices to manage resources like water and traffic more effectively.</li>
            </ul>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">Smart Cities Council</a></li>
              <li><a href="#" class="link-primary">World Bank: Smart Cities</a></li>
            </ul>
          `,
        },
      };

      const SOURCES = {
        1: {
          title: "Reuters: A Global, Fact-Based Approach",
          body: `
            <p><strong>Profile:</strong> Reuters is one of the world's largest and most respected international news agencies. Its core business is providing breaking news, in-depth reports, and multimedia content to other news organizations and financial markets worldwide.</p>
            <p><strong>Key Characteristics:</strong></p>
            <ul>
              <li><strong>Journalistic Standards:</strong> Known for its commitment to speed, accuracy, and impartiality. Reuters has a strict editorial policy that prohibits its journalists from expressing personal opinions on public issues.</li>
              <li><strong>Ownership:</strong> Part of Thomson Reuters, a multinational media and information company. Its ownership structure is designed to protect its journalistic independence.</li>
              <li><strong>Political Leanings:</strong> Widely regarded as a neutral and objective source. It's often used as a benchmark for factual reporting.</li>
            </ul>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">Reuters Editorial Handbook</a></li>
              <li><a href="#" class="link-primary">Pew Research Center analysis on media bias</a></li>
            </ul>
          `,
        },
        2: {
          title: "How to Spot Misleading Headlines",
          body: `
            <p><strong>Misleading headlines</strong> are designed to sensationalize a story or provoke a strong emotional reaction, often by taking quotes or facts out of context. Here’s how to spot them:</p>
            <p><strong>What to Look For:</strong></p>
            <ul>
              <li><strong>Emotional Language:</strong> Headlines that use words like "shocking," "outrageous," or "unbelievable."</li>
              <li><strong>Vague or Ambiguous Claims:</strong> Headlines that make broad statements without providing specific details.</li>
              <li><strong>Clickbait:</strong> Headlines that promise a big reveal or secret but fail to deliver, forcing you to click through to an article that doesn't live up to the hype.</li>
              <li><strong>Taking Quotes Out of Context:</strong> A headline might use a quote that sounds controversial, but the full article reveals the quote was part of a larger, more nuanced statement.</li>
            </ul>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">First Draft News: Guide to Misinformation</a></li>
              <li><a href="#" class="link-primary">Poynter Institute: How to Spot Fake News</a></li>
            </ul>
          `,
        },
        3: {
          title: "The Verge: Tech News with a Human Touch",
          body: `
            <p><strong>Profile:</strong> The Verge is an American technology news and media network. It focuses on the intersection of technology, science, art, and culture. Its mission is to explain how technology is changing the world in an accessible and engaging way.</p>
            <p><strong>Key Characteristics:</strong></p>
            <ul>
              <li><strong>Journalistic Standards:</strong> Known for its high-quality production, deep-dive reviews, and a narrative-driven approach to tech journalism. It often includes both the technical specs and the broader cultural impact of a product.</li>
              <li><strong>Ownership:</strong> A part of Vox Media, which owns several other popular online brands.</li>
              <li><strong>Political Leanings:</strong> Generally seen as non-partisan, but with a focus on topics like privacy, ethics in AI, and digital rights, which can have political implications.</li>
            </ul>
            <p class="small text-muted mt-3"><strong>Sources:</strong></p>
            <ul>
              <li><a href="#" class="link-primary">The Verge Editorial Charter</a></li>
              <li><a href="#" class="link-primary">TechCrunch profile of Vox Media</a></li>
            </ul>
          `,
        },
      };

      const MOCK_STORIES = Array.from({ length: 150 }).map((_, i) => ({
        id: i + 1,
        title: [
          "Government unveils new education policy focus on digital equity",
          "Breakthrough in AI model compression cuts energy use",
          "Monsoon brings relief to North India, IMD issues advisory",
          "Markets steady as inflation eases; RBI outlook in focus",
          "Study shows coral reefs rebounding in protected zones",
          "New cyber law proposes stronger privacy safeguards",
          "Researchers map urban heat islands across major cities",
          "Startup launches affordable satellite internet service",
          "Healthcare access improves with telemedicine push",
          "Wildlife corridors reduce human-animal conflict",
          "Space agency schedules next lunar mission window",
          "Tech giants back open-source security initiative",
          "Local trains add women-only coaches during peak hours",
          "Farmers adopt smart irrigation; water use drops",
          "Clean energy investments hit record high",
          "Data protection board releases compliance toolkit",
          "Education loans: new subsidized scheme announced",
          "Scientists track microplastics in major rivers",
          "Public transport card rolls out nationwide",
          "Green hydrogen pilot shows promising results",
          "Severe weather alerts: states on preparedness",
          "Major sports event adopts concussion protocol",
          "Libraries reimagined as digital learning hubs",
          "Researchers publish AI ethics benchmark",
          "New policy to boost EV manufacturing",
          "Robotics competition sees record participation",
          "Global supply chain issues ease slightly",
          "Gene therapy shows promise in clinical trials",
          "AI-generated art sparks copyright debate",
          "Rural broadband initiative exceeds targets",
          "Volcano eruption in Pacific raises tsunami concerns",
          "Inflation rate drops to three-year low",
          "SpaceX launches reusable rocket for new constellation",
          "Global summit on climate finance concludes",
          "Smart cities project wins international award",
          "New film festival celebrates independent cinema",
          "Archaeologists discover ancient trade route artifacts",
          "E-commerce boom drives warehouse automation",
          "Cryptocurrency regulations proposed in new bill",
          "Solar energy grid expands in southern states",
          "Major film studio merges with streaming platform",
          "Local music festival promotes emerging artists",
          "New research suggests link between sleep and cognitive function",
          "Government announces new guidelines for sustainable fashion",
          "Urban planners debate pedestrian-only zones",
          "World leaders meet to discuss new trade agreements",
          "New fitness tracking app uses AI for personalized plans",
          "Food security summit addresses global supply chain issues",
          "New archaeological dig uncovers ancient city ruins",
          "International space station celebrates 25 years of service",
          "India's Chandrayaan program eyes a new lunar landing site",
          "Cricket World Cup final brings nation to a halt",
          "Bollywood blockbuster breaks box office records",
          "Study finds new species of deep-sea fish in Indian Ocean",
          "India's tech sector sees record venture capital funding",
          "New policy on data localization sparks debate",
          "Art exhibition highlights indigenous artists from across India",
          "Start-up develops low-cost home water purification system",
          "India's space tourism industry set for launch",
          "Government launches nationwide tree-planting drive to combat desertification",
          "Local cricket team wins national championship",
          "New health report suggests rise in mental health issues",
          "Fashion week showcases sustainable designs from Indian creators",
          "Political rally draws massive crowd ahead of elections",
          "Ancient temple restoration project uncovers hidden sculptures",
          "New report questions government's stance on renewable energy",
          "Startup aims to revolutionize grocery delivery with drone technology",
          "AI models now composing music that's indistinguishable from human artists",
          "Community leaders organize festival to celebrate local culture",
          "Debate over national digital privacy bill intensifies in parliament",
          "New wellness trend promotes 'digital detox' for a healthier lifestyle",
          "Scientists discover a new form of ice in the lab",
          "Latest gaming console sells out in minutes after launch",
          "City council approves new park and green space initiatives",
          "Study finds a link between social media use and sleep disruption",
          "Documentary on Himalayan ecology wins prestigious award",
          "Cryptocurrency market sees a sharp drop amidst regulatory uncertainty",
          "New art exhibit uses virtual reality to showcase ancient civilizations",
          "India's economy grows by 7.5% in the last quarter",
          "Local food blogger gains international recognition",
          "New species of butterfly discovered in the Western Ghats",
          "Political satire show gains popularity with sharp commentary",
          "Fitness experts warn against dangers of over-training",
          "Government's new infrastructure plan focuses on rural connectivity",
          "SpaceX announces plans for a Martian colony simulation",
          "New climate pact signed by G20 nations in a landmark agreement",
          "Film industry debates the use of AI in screenwriting",
          "Traditional dance form sees a revival with new generation of artists",
          "Public opinion poll shows a decline in trust in mainstream media",
          "New vegan restaurant chain opens in major cities",
          "Researchers develop a new battery that charges in seconds",
          "Celebrity wedding of the year dominates social media",
          "IPL team sold for a record-breaking sum of money",
          "International summit on water security concludes with new proposals",
          "New travel blog highlights hidden gems in remote Indian villages",
          "Parliamentary debate on new tax reform bill gets heated",
          "Global report shows a decrease in carbon emissions from developing nations",
          "Local farmer's market sees boom in popularity",
          "Health study links air pollution to chronic illness",
          "New law on online gaming sparks controversy",
          "India's new renewable energy capacity hits record high",
          "Film industry grappling with piracy challenges",
          "Community garden project helps local food bank",
          "New app helps track and reduce your carbon footprint",
          "Political party releases manifesto focused on youth employment",
          "Art gallery hosts digital art exhibition powered by AI",
          "Sports league introduces new concussion safety protocols",
          "Study finds significant decline in global bee population",
          "Debate over public land use for commercial development",
          "Fashion brand launches fully biodegradable clothing line",
          "New museum dedicated to Indian history opens",
          "Tech company announces new ethical AI framework",
          "Report shows steady increase in global life expectancy",
          "Local cafe becomes a hub for community meetings",
          "New regulations on plastic waste announced",
          "India's Olympic athletes prepare for upcoming games",
          "Festival celebrating diverse cultures draws record crowds",
          "New government policy aims to protect endangered wildlife",
          "Fintech startup raises capital with focus on rural banking",
          "Social media platform under fire for data privacy issues",
          "New report on global freshwater supplies raises alarm",
          "Government signs a new trade agreement with European nations",
          "Popular artist's new album breaks streaming records",
          "International chess tournament held in Delhi",
          "New study on the benefits of meditation published",
          "Billionaire's space company plans moon mission",
          "Urban farming initiative takes root in several Indian cities",
          "Major political party announces new leader",
          "New film explores the history of Indian cuisine",
        ][i],
        source: [
          "Reuters",
          "BBC",
          "The Hindu",
          "Indian Express",
          "AP",
          "Mint",
          "NDTV",
          "Bloomberg",
          "The Verge",
          "Nature",
          "TechCrunch",
          "Science Magazine",
          "CNN",
          "Al Jazeera",
          "Zee News",
          "Dainik Bhaskar",
          "Times of India",
        ][i % 17],
        img: `https://picsum.photos/seed/${i + 11}/800/500`,
        minutes: 4 + (i % 12),
        credibility: [
          "high",
          "high",
          "medium",
          "high",
          "high",
          "medium",
          "high",
          "medium",
          "high",
          "high",
          "medium",
          "high",
          "low",
          "medium",
          "low",
          "low",
          "medium",
        ][i % 17],
        category: [
          "Politics",
          "Tech",
          "India",
          "Business",
          "Science",
          "Politics",
          "Climate",
          "Tech",
          "Health",
          "Science",
          "Tech",
          "Tech",
          "India",
          "India",
          "Climate",
          "Politics",
          "India",
          "Science",
          "India",
          "Climate",
          "India",
          "Sports",
          "Culture",
          "Tech",
          "Business",
          "Tech",
          "World",
          "Science",
          "Tech",
          "Tech",
          "World",
          "Business",
          "Tech",
          "Climate",
          "World",
          "Entertainment",
          "Culture",
          "Business",
          "Politics",
          "Climate",
          "Entertainment",
          "Entertainment",
          "Health",
          "Lifestyle",
          "Lifestyle",
          "Politics",
          "Tech",
          "World",
          "Culture",
          "Science",
          "Tech",
          "Sports",
          "Entertainment",
          "Science",
          "Tech",
          "Politics",
          "Culture",
          "Business",
          "Tech",
          "Climate",
          "Sports",
          "Health",
          "Lifestyle",
          "Politics",
          "Culture",
          "Climate",
          "Tech",
          "Entertainment",
          "Culture",
          "Politics",
          "Lifestyle",
          "Science",
          "Entertainment",
          "Climate",
          "Health",
          "Entertainment",
          "Business",
          "Culture",
          "Politics",
          "Lifestyle",
          "Science",
          "Politics",
          "Sports",
          "India",
          "Tech",
          "Climate",
          "Entertainment",
          "Culture",
          "Politics",
          "Lifestyle",
          "Science",
          "Entertainment",
          "Sports",
          "World",
          "Lifestyle",
          "Politics",
          "Climate",
          "Business",
          "Health",
          "Politics",
          "Climate",
          "Entertainment",
          "Lifestyle",
          "Climate",
          "Politics",
          "Culture",
          "Sports",
          "Science",
          "Politics",
          "Lifestyle",
          "Culture",
          "Tech",
          "Health",
          "Lifestyle",
          "Climate",
          "Sports",
          "Culture",
          "Climate",
          "Business",
          "Tech",
          "World",
          "Politics",
          "Entertainment",
          "Sports",
          "Health",
          "Tech",
          "Lifestyle",
          "Politics",
          "Entertainment",
        ][i],
        factChecked: i % 3 !== 0,
        published: new Date(Date.now() - i * 3600 * 1000).toISOString(),
        summary:
          "This is a concise, readable summary highlighting the core facts first, then adding context and quotes. Ideal for skimming.",
        body: `\n<p><strong>Lead:</strong> The story opens with the most verifiable facts, then explains the context in plain language. Bullet points summarize key takeaways for quick scanning.</p>\n<ul>\n  <li>What happened: verifiable event with time and place.</li>\n  <li>Why it matters: impact on readers and society.</li>\n  <li>What’s next: upcoming decisions, dates, or data releases.</li>\n</ul>\n<p>Quotes are attributed, data sources are linked, and any uncertainty or limitations are clearly labeled. Jargon is minimized, acronyms are expanded on first use, and numbers are rounded for clarity. Charts and images include descriptive alt text.</p>\n<p class='mb-0'>Our <em>Transparency Box</em> explains methods and provides links to full datasets when available.</p>`,
        whyCredible: [
          "Source has a track record of factual reporting and corrections.",
          "Multiple independent confirmations included.",
          "Direct links to primary documents and data.",
          "Clearly separates news from opinion.",
        ],
        sources: [
          "Official press release / gov portal",
          "Dataset / PDF from a reputable institution",
          "Eyewitness or expert interview transcript",
        ],
      }));

      const state = {
        theme:
          localStorage.getItem("sift-theme") ||
          (window.matchMedia("(prefers-color-scheme: dark)").matches
            ? "dark"
            : "light"),
        highContrast: localStorage.getItem("sift-contrast") === "1",
        fontScale: parseFloat(localStorage.getItem("sift-font-scale") || "1"),
        density: localStorage.getItem("sift-density") || "comfort",
        accessibleFont: localStorage.getItem("sift-accessible-font") === "1",
        filters: {
          q: "",
          category: "Top",
          cred: "high",
          maxMinutes: 10,
          factOnly: false,
        },
        cursorIndex: 0,
        page: 1,
        pageSize: 8,
        bookmarks: JSON.parse(localStorage.getItem("sift-bookmarks") || "[]"),
      };

      let readerModal, mythModal, explainerModal, sourceModal;

      function applyPrefs() {
        document.documentElement.setAttribute("data-bs-theme", state.theme);
        document.documentElement.setAttribute(
          "data-contrast",
          state.highContrast ? "high" : ""
        );
        document.body.style.fontSize = state.fontScale.toFixed(2) + "rem";
        document.body.style.fontFamily = state.accessibleFont
          ? "var(--cn-font-accessible)"
          : "var(--cn-font)";
        updateEnergyImpact();
      }

      function updateEnergyImpact() {
        const el = document.getElementById("energyImpact");
        if (state.theme === "dark") {
          el.innerHTML = `<i class="bi bi-battery-half me-1"></i> Browsing in Dark Mode saves battery.`;
        } else {
          el.innerHTML = `<i class="bi bi-battery-full text-success me-1"></i> Browsing in Light Mode consumes more power.`;
        }
      }

      function fetchAndRenderWeather() {
        const weatherData = {
          location: "Majitar, Sikkim",
          temp: "31°C",
          condition: "heavy thunderstorm",
          icon: "cloud-lightning-rain",
        };
        const iconClass = getWeatherIconClass(weatherData.condition);
        const weatherHtml = `
          <i class="bi ${iconClass} me-2"></i>
          <span class="d-none d-lg-inline">${weatherData.location}</span>
          <span class="fw-bold">${weatherData.temp}</span>
        `;
        document.getElementById("weatherInfo").innerHTML = weatherHtml;
      }

      function getWeatherIconClass(condition) {
        if (condition.includes("storm")) return "bi-cloud-lightning-rain";
        if (condition.includes("rain")) return "bi-cloud-rain";
        if (condition.includes("cloud")) return "bi-cloud-fill";
        if (condition.includes("sun")) return "bi-sun-fill";
        return "bi-cloud-fill";
      }

      function buildSidebar() {
        const chipWrap = document.getElementById("categoryChips");
        chipWrap.innerHTML = "";
        CATEGORIES.forEach((cat) => {
          const btn = document.createElement("button");
          btn.className =
            "btn btn-sm " +
            (state.filters.category === cat
              ? "btn-primary"
              : "btn-outline-primary");
          btn.textContent = cat;
          btn.setAttribute("data-cat", cat);
          btn.addEventListener("click", () => {
            state.filters.category = cat;
            renderFeed(true);
          });
          chipWrap.appendChild(btn);
        });

        const gList = document.getElementById("googleTrends");
        gList.innerHTML = "";
        GOOGLE_QUERIES.forEach((q) => {
          const li = document.createElement("li");
          const a = document.createElement("a");
          a.href = "#";
          a.className = "link-underline-opacity-0 link-underline";
          a.textContent = q;
          a.addEventListener("click", () => {
            document.getElementById("searchInput").value = q;
            state.filters.q = q;
            renderFeed(true);
          });
          li.appendChild(a);
          gList.appendChild(li);
        });
      }

      function getFiltered() {
        const start = 0;
        let items = MOCK_STORIES.slice(start);
        const q = state.filters.q.toLowerCase();
        if (q) {
          items = items.filter((s) =>
            (s.title + " " + s.summary + " " + s.category + " " + s.source)
              .toLowerCase()
              .includes(q)
          );
        }
        if (state.filters.category && state.filters.category !== "Top") {
          items = items.filter((s) => s.category === state.filters.category);
        }
        if (state.filters.cred !== "all") {
          items = items.filter((s) => s.credibility === state.filters.cred);
        }
        if (state.filters.maxMinutes) {
          items = items.filter((s) => s.minutes <= state.filters.maxMinutes);
        }
        if (state.filters.factOnly) {
          items = items.filter((s) => s.factChecked);
        }
        return items;
      }

      function renderFeed(reset = false) {
        const feed = document.getElementById("feed");
        const countEl = document.getElementById("resultsCount");
        const list = getFiltered();
        countEl.textContent = `${list.length} article${
          list.length !== 1 ? "s" : ""
        }`;

        if (reset) {
          state.page = 1;
          feed.innerHTML = "";
        }

        if (list.length === 0) {
          feed.innerHTML = `
            <div class="col-12 text-center text-muted py-5">
              <h3>No articles found!</h3>
              <p>Try broadening your search or adjusting your filters.</p>
              <i class="bi bi-emoji-frown h1"></i>
            </div>
          `;
          document.getElementById("loadMore").style.display = "none";
          return;
        }

        feed.setAttribute("aria-busy", "true");
        const show = list.slice(0, state.page * state.pageSize);
        if (reset) {
          for (let i = 0; i < Math.min(6, state.pageSize); i++) {
            const skel = document.createElement("div");
            skel.className = "col-md-6 col-xl-4";
            skel.innerHTML = `<div class='news-card shimmer' style='height:280px'></div>`;
            feed.appendChild(skel);
          }
        }

        setTimeout(() => {
          feed.innerHTML = "";
          show.forEach((s, idx) => feed.appendChild(cardTemplate(s, idx)));
          feed.removeAttribute("aria-busy");
          document.getElementById("loadMore").style.display =
            list.length > show.length ? "block" : "none";
        }, 350);
      }

      function cardTemplate(s, idx) {
        const col = document.createElement("div");
        col.className = "col-md-6 col-xl-4";
        col.setAttribute("data-index", idx);
        const saved = state.bookmarks.includes(s.id);
        col.innerHTML = `
      <div class="card news-card h-100 position-relative" role="article" aria-labelledby="title-${
        s.id
      }">
        <button class="btn btn-sm pin" title="Bookmark" data-action="bookmark" aria-pressed="${saved}" aria-label="Bookmark article ${
          s.title
        }"><i class="bi ${
          saved ? "bi-bookmark-fill" : "bi-bookmark"
        }"></i></button>
        <img src="${s.img}" class="card-img-top" alt="Thumbnail for ${s.title}">
        <div class="card-body d-flex flex-column">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="badge text-bg-light"><i class="bi bi-newspaper me-1"></i>${
              s.source
            }</span>
            <span class="badge badge-cred" data-level="${
              s.credibility
            }" data-bs-toggle="tooltip" data-bs-placement="top" title="${getCredibilityTooltip(
          s.credibility
        )}">${
          s.credibility.charAt(0).toUpperCase() + s.credibility.slice(1)
        }</span>
          </div>
          <h3 class="h6 fw-bold" id="title-${s.id}">${s.title}</h3>
          <p class="text-muted small flex-grow-1">${s.summary}</p>
          <div class="d-flex justify-content-between align-items-center mt-2">
            <span class="small text-muted"><i class="bi bi-clock me-1"></i>${
              s.minutes
            } min</span>
            <div class="d-flex align-items-center gap-2">
              <button class="btn btn-sm btn-primary" data-action="open" data-id="${
                s.id
              }">Read</button>
              <button class="btn btn-sm btn-outline-secondary" data-action="share" data-id="${
                s.id
              }"><i class="bi bi-share"></i></button>
            </div>
          </div>
        </div>
      </div>`;

        col
          .querySelector('[data-action="open"]')
          .addEventListener("click", () => openReader(s));
        col
          .querySelector('[data-action="share"]')
          .addEventListener("click", () => shareStory(s));
        col
          .querySelector('[data-action="bookmark"]')
          .addEventListener("click", (e) => toggleBookmark(e, s));

        new bootstrap.Tooltip(col.querySelector('[data-bs-toggle="tooltip"]'));
        return col;
      }

      function getCredibilityTooltip(level) {
        if (level === "high") {
          return "Fact-checked by third-party organizations and uses multiple reputable sources.";
        }
        if (level === "medium") {
          return "Published by a mainstream news outlet but may lack detailed sourcing or be an opinion piece.";
        }
        return "Source may have a history of misinformation or be based on unverified claims.";
      }

      function openReader(s) {
        const modal = document.getElementById("readerModal");
        const titleEl = modal.querySelector("#readerTitle");
        const metaEl = modal.querySelector("#readerMeta");
        const credEl = modal.querySelector("#readerCred");
        const bodyEl = modal.querySelector("#readerBody");
        const whyEl = modal.querySelector("#readerWhy");
        const sourcesEl = modal.querySelector("#readerSources");
        const saveButton = modal.querySelector("#readerSave");

        titleEl.textContent = s.title;
        metaEl.textContent = `${s.source} • ${Math.max(
          1,
          Math.round((Date.now() - new Date(s.published)) / 3600000)
        )}h ago • ${s.minutes} min`;
        credEl.textContent = `${s.credibility} credibility`;
        credEl.setAttribute("data-level", s.credibility);

        bodyEl.innerHTML = s.body;
        whyEl.innerHTML = s.whyCredible.map((x) => `<li>${x}</li>`).join("");
        sourcesEl.innerHTML = s.sources.map((x) => `<li>${x}</li>`).join("");

        bodyEl.style.fontSize = (1 * state.fontScale).toFixed(2) + "rem";
        bodyEl.setAttribute("data-density", state.density);
        modal.querySelector("#readerProgress").style.width = "0%";
        saveButton.onclick = () => {
          saveBookmark(s.id);
          toast("Saved to bookmarks");
        };

        const modalBody = modal.querySelector(".modal-body");
        modalBody.onscroll = () => {
          const p =
            modalBody.scrollTop /
            (modalBody.scrollHeight - modalBody.clientHeight);
          modal.querySelector("#readerProgress").style.width =
            (p * 100).toFixed(0) + "%";
        };

        readerModal.show();
      }

      function shareStory(s) {
        const shareData = {
          title: s.title,
          text: s.summary,
          url: location.href.split("#")[0] + `#story-${s.id}`,
        };
        if (navigator.share) {
          navigator.share(shareData).catch(() => {});
        } else {
          navigator.clipboard.writeText(`${s.title} — ${shareData.url}`);
          toast("Link copied to clipboard");
        }
      }

      function saveBookmark(id) {
        if (!state.bookmarks.includes(id)) {
          state.bookmarks.push(id);
          localStorage.setItem(
            "sift-bookmarks",
            JSON.stringify(state.bookmarks)
          );
        }
      }
      function removeBookmark(id) {
        state.bookmarks = state.bookmarks.filter((x) => x !== id);
        localStorage.setItem("sift-bookmarks", JSON.stringify(state.bookmarks));
      }
      function toggleBookmark(e, s) {
        const icon = e.currentTarget.querySelector("i");
        if (state.bookmarks.includes(s.id)) {
          removeBookmark(s.id);
          icon.className = "bi bi-bookmark";
          e.currentTarget.setAttribute("aria-pressed", "false");
          toast("Removed from bookmarks");
        } else {
          saveBookmark(s.id);
          icon.className = "bi bi-bookmark-fill";
          e.currentTarget.setAttribute("aria-pressed", "true");
          toast("Saved to bookmarks");
        }
      }

      function toast(msg) {
        const el = document.getElementById("toaster");
        el.querySelector(".toast-body").textContent = msg;
        new bootstrap.Toast(el).show();
      }

      const PRESETS = {
        student: {
          fontScale: 1,
          density: "comfort",
          theme: "light",
          maxMinutes: 8,
        },
        professional: {
          fontScale: 0.95,
          density: "compact",
          theme: "light",
          maxMinutes: 10,
        },
        elder: {
          fontScale: 1.15,
          density: "relaxed",
          theme: "light",
          maxMinutes: 12,
          accessibleFont: true,
        },
      };

      function applyPreset(name) {
        const p = PRESETS[name];
        if (!p) return;
        Object.assign(state, p, {
          filters: { ...state.filters, maxMinutes: p.maxMinutes },
        });
        state.accessibleFont = !!p.accessibleFont;
        persistPrefs();
        applyPrefs();
        document.getElementById("rtRange").value = state.filters.maxMinutes;
        document.getElementById("rtVal").textContent = state.filters.maxMinutes;
        renderFeed(true);
      }

      function persistPrefs() {
        localStorage.setItem("sift-theme", state.theme);
        localStorage.setItem("sift-contrast", state.highContrast ? "1" : "");
        localStorage.setItem("sift-font-scale", String(state.fontScale));
        localStorage.setItem("sift-density", state.density);
        localStorage.setItem(
          "sift-accessible-font",
          state.accessibleFont ? "1" : ""
        );
      }

      function setupKeyboard() {
        window.addEventListener("keydown", (e) => {
          if (e.key === "/" && document.activeElement.tagName !== "INPUT") {
            e.preventDefault();
            document.getElementById("searchInput").focus();
          }
          if (e.key === "?") {
            const kb = new bootstrap.Modal("#kbModal");
            kb.show();
          }
          const cards = Array.from(
            document.querySelectorAll('#feed [role="article"]')
          );
          if (["j", "k", "o", "b"].includes(e.key) && cards.length) {
            const max = cards.length - 1;
            if (e.key === "j") {
              state.cursorIndex = Math.min(max, state.cursorIndex + 1);
              cards[state.cursorIndex].scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
              highlightCard(cards[state.cursorIndex]);
            }
            if (e.key === "k") {
              state.cursorIndex = Math.max(0, state.cursorIndex - 1);
              cards[state.cursorIndex].scrollIntoView({
                behavior: "smooth",
                block: "center",
              });
              highlightCard(cards[state.cursorIndex]);
            }
            if (e.key === "o") {
              cards[state.cursorIndex]
                .querySelector('[data-action="open"]')
                .click();
            }
            if (e.key === "b") {
              cards[state.cursorIndex]
                .querySelector('[data-action="bookmark"]')
                .click();
            }
          }
        });
      }
      function highlightCard(el) {
        cardsClearHighlight();
        el.classList.add("border", "border-primary", "shadow");
        setTimeout(() => {
          el.classList.remove("border", "border-primary", "shadow");
        }, 600);
      }
      function cardsClearHighlight() {
        document
          .querySelectorAll('#feed [role="article"]')
          .forEach((el) =>
            el.classList.remove("border", "border-primary", "shadow")
          );
      }

      function wireUI() {
        document
          .querySelectorAll("[data-preset]")
          .forEach((btn) =>
            btn.addEventListener("click", () => applyPreset(btn.dataset.preset))
          );
        document.querySelectorAll("[data-theme]").forEach((btn) =>
          btn.addEventListener("click", () => {
            state.theme = btn.dataset.theme;
            persistPrefs();
            applyPrefs();
          })
        );
        document.querySelectorAll("[data-contrast]").forEach((btn) =>
          btn.addEventListener("click", () => {
            state.highContrast = !state.highContrast;
            persistPrefs();
            applyPrefs();
          })
        );
        document.querySelectorAll("[data-font]").forEach((btn) =>
          btn.addEventListener("click", () => {
            const v = btn.dataset.font;
            if (v === "0") state.fontScale = 1;
            if (v === "+")
              state.fontScale = Math.min(1.3, state.fontScale + 0.05);
            if (v === "-")
              state.fontScale = Math.max(0.85, state.fontScale - 0.05);
            persistPrefs();
            applyPrefs();
          })
        );

        document
          .getElementById("densityRange")
          .addEventListener("input", (e) => {
            state.density =
              ["compact", "comfort", "relaxed"][parseInt(e.target.value, 10)] ||
              "comfort";
            persistPrefs();
            document
              .querySelectorAll(".reader-content")
              .forEach((el) => el.setAttribute("data-density", state.density));
          });

        document
          .getElementById("dyslexiaFontSwitch")
          .addEventListener("change", (e) => {
            state.accessibleFont = e.target.checked;
            persistPrefs();
            applyPrefs();
          });

        document
          .getElementById("searchInput")
          .addEventListener("input", (e) => {
            state.filters.q = e.target.value.trim();
            renderFeed(true);
          });

        document.getElementById("searchBtn").addEventListener("click", () => {
          state.filters.q = document.getElementById("searchInput").value.trim();
          renderFeed(true);
        });
        document
          .getElementById("searchInput")
          .addEventListener("keydown", (e) => {
            if (e.key === "Enter") {
              e.preventDefault();
              state.filters.q = e.target.value.trim();
              renderFeed(true);
            }
          });

        document.querySelectorAll("[data-cred]").forEach((btn) =>
          btn.addEventListener("click", () => {
            document
              .querySelectorAll("[data-cred]")
              .forEach((b) => b.classList.remove("active"));
            btn.classList.add("active");
            state.filters.cred = btn.dataset.cred;
            renderFeed(true);
          })
        );
        document.getElementById("rtRange").addEventListener("input", (e) => {
          state.filters.maxMinutes = parseInt(e.target.value, 10);
          document.getElementById("rtVal").textContent =
            state.filters.maxMinutes;
        });
        document
          .getElementById("rtRange")
          .addEventListener("change", () => renderFeed(true));
        document
          .getElementById("factCheckOnly")
          .addEventListener("change", (e) => {
            state.filters.factOnly = e.target.checked;
            renderFeed(true);
          });

        document
          .getElementById("resetFilters")
          .addEventListener("click", () => {
            state.filters = {
              q: "",
              category: "Top",
              cred: "all",
              maxMinutes: 10,
              factOnly: false,
            };
            document.getElementById("searchInput").value = "";
            document.getElementById("rtRange").value = 10;
            document.getElementById("rtVal").textContent = 10;
            document.getElementById("factCheckOnly").checked = false;
            document
              .querySelectorAll("[data-cred]")
              .forEach((b) => b.classList.remove("active"));
            document
              .querySelector('[data-cred="high"]')
              .classList.add("active");
            renderFeed(true);
          });

        document.getElementById("loadMore").addEventListener("click", () => {
          state.page++;
          renderFeed(false);
        });

        document
          .getElementById("openFeatured")
          .addEventListener("click", () => openReader(MOCK_STORIES[0]));
        document
          .getElementById("saveFeatured")
          .addEventListener("click", () => {
            saveBookmark(MOCK_STORIES[0].id);
            toast("Saved to bookmarks");
          });

        document
          .getElementById("readerFontInc")
          .addEventListener("click", () => {
            const el = document.getElementById("readerBody");
            const s = parseFloat(getComputedStyle(el).fontSize);
            el.style.fontSize = s + 1 + "px";
          });
        document
          .getElementById("readerFontDec")
          .addEventListener("click", () => {
            const el = document.getElementById("readerBody");
            const s = parseFloat(getComputedStyle(el).fontSize);
            el.style.fontSize = Math.max(14, s - 1) + "px";
          });

        document.querySelectorAll("[data-density]").forEach((btn) =>
          btn.addEventListener("click", () => {
            document
              .getElementById("readerBody")
              .setAttribute("data-density", btn.dataset.density);
          })
        );

        document
          .querySelectorAll('[data-bs-target="#mythModal"]')
          .forEach((btn) => {
            btn.addEventListener("click", (e) => {
              const mythId = e.currentTarget.dataset.mythId;
              const mythData = MYTHS[mythId];
              if (mythData) {
                document.getElementById(
                  "mythModalTitle"
                ).innerHTML = `<i class="bi bi-patch-question-fill me-2"></i> Myth Buster: ${mythData.title}`;
                document.getElementById("mythModalContent").innerHTML =
                  mythData.body;
                mythModal.show();
              }
            });
          });

        document
          .querySelectorAll('[data-bs-target="#explainerModal"]')
          .forEach((btn) => {
            btn.addEventListener("click", (e) => {
              const explainerId = e.currentTarget.dataset.explainerId;
              const explainerData = EXPLAINERS[explainerId];
              if (explainerData) {
                document.getElementById(
                  "explainerModalTitle"
                ).innerHTML = `<i class="bi bi-info-circle-fill me-2"></i> Explainer: ${explainerData.title}`;
                document.getElementById("explainerModalContent").innerHTML =
                  explainerData.body;
                explainerModal.show();
              }
            });
          });

        document
          .querySelectorAll('[data-bs-target="#sourceModal"]')
          .forEach((btn) => {
            btn.addEventListener("click", (e) => {
              const sourceId = e.currentTarget.dataset.sourceId;
              const sourceData = SOURCES[sourceId];
              if (sourceData) {
                document.getElementById(
                  "sourceModalTitle"
                ).innerHTML = `<i class="bi bi-journal-text me-2"></i> Source Spotlight: ${sourceData.title}`;
                document.getElementById("sourceModalContent").innerHTML =
                  sourceData.body;
                sourceModal.show();
              }
            });
          });

        document
          .getElementById("viewBookmarks")
          .addEventListener("click", () => {
            const items = MOCK_STORIES.filter((s) =>
              state.bookmarks.includes(s.id)
            );
            if (!items.length) {
              toast(
                "Your bookmarks are empty. Star an article to save it for later!"
              );
              return;
            }
            const first = items[0];
            openReader(first);
            document
              .getElementById("readerWhy")
              .insertAdjacentHTML(
                "beforebegin",
                `<div class='alert alert-info rounded-2xl'><i class='bi bi-bookmarks me-2'></i>You have ${
                  items.length
                } bookmarked article${
                  items.length > 1 ? "s" : ""
                }. Use <kbd>j</kbd>/<kbd>k</kbd> to browse the list on the homepage.</div>`
              );
          });
      }

      (function init() {
        applyPrefs();
        buildSidebar();
        fetchAndRenderWeather();
        document.getElementById("rtRange").value = state.filters.maxMinutes;
        document.getElementById("rtVal").textContent = state.filters.maxMinutes;
        document.getElementById("dyslexiaFontSwitch").checked =
          state.accessibleFont;
        renderFeed(true);
        wireUI();
        setupKeyboard();

        readerModal = new bootstrap.Modal(
          document.getElementById("readerModal")
        );
        mythModal = new bootstrap.Modal(document.getElementById("mythModal"));
        explainerModal = new bootstrap.Modal(
          document.getElementById("explainerModal")
        );
        sourceModal = new bootstrap.Modal(
          document.getElementById("sourceModal")
        );
      })();
    </script>
  </body>
</html>
